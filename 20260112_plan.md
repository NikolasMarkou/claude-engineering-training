# Budgeting App - Implementation Plan

## Overview
Single-user budgeting application with PIN protection, featuring transaction tracking, monthly budgets, recurring transactions, savings goals, and visual analytics.

## Tech Stack
- **Backend**: FastAPI + SQLite (with SQLAlchemy ORM)
- **Frontend**: SvelteKit
- **Python**: Virtual environment (venv)

---

## Features Summary

| Feature | Details |
|---------|---------|
| Auth | Single-user with PIN/password |
| Transactions | Income/expenses with categories |
| Categories | Predefined defaults + user-created custom |
| Budgets | Monthly budgets per category |
| Recurring | Auto-generated on schedule |
| Savings Goals | Target amount + deadline tracking |
| Reports | Charts, trends, category breakdowns |
| Import | CSV file import |
| Currency | Single currency (configurable) |
| Accounts | Single pool (no multi-account) |

---

## Project Structure

```
claude-engineering-training/
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py              # FastAPI app entry
│   │   ├── config.py            # Settings, currency config
│   │   ├── database.py          # SQLite/SQLAlchemy setup
│   │   ├── models/              # SQLAlchemy models
│   │   │   ├── __init__.py
│   │   │   ├── user.py          # PIN/password storage
│   │   │   ├── transaction.py
│   │   │   ├── category.py
│   │   │   ├── budget.py
│   │   │   ├── recurring.py
│   │   │   └── goal.py
│   │   ├── schemas/             # Pydantic schemas
│   │   │   ├── __init__.py
│   │   │   ├── transaction.py
│   │   │   ├── category.py
│   │   │   ├── budget.py
│   │   │   ├── recurring.py
│   │   │   └── goal.py
│   │   ├── routers/             # API endpoints
│   │   │   ├── __init__.py
│   │   │   ├── auth.py
│   │   │   ├── transactions.py
│   │   │   ├── categories.py
│   │   │   ├── budgets.py
│   │   │   ├── recurring.py
│   │   │   ├── goals.py
│   │   │   ├── reports.py
│   │   │   └── import_export.py
│   │   ├── services/            # Business logic
│   │   │   ├── __init__.py
│   │   │   ├── recurring_service.py  # Auto-generate logic
│   │   │   ├── budget_service.py
│   │   │   ├── report_service.py
│   │   │   └── csv_service.py
│   │   └── utils/
│   │       └── security.py      # PIN hashing
│   ├── requirements.txt
│   └── alembic/                 # DB migrations (optional)
├── frontend/
│   ├── src/
│   │   ├── routes/
│   │   │   ├── +layout.svelte
│   │   │   ├── +page.svelte          # Dashboard
│   │   │   ├── login/+page.svelte
│   │   │   ├── transactions/+page.svelte
│   │   │   ├── budgets/+page.svelte
│   │   │   ├── goals/+page.svelte
│   │   │   ├── recurring/+page.svelte
│   │   │   ├── reports/+page.svelte
│   │   │   └── settings/+page.svelte
│   │   ├── lib/
│   │   │   ├── api.ts           # API client
│   │   │   ├── stores/          # Svelte stores
│   │   │   └── components/
│   │   │       ├── TransactionForm.svelte
│   │   │       ├── TransactionList.svelte
│   │   │       ├── BudgetCard.svelte
│   │   │       ├── GoalProgress.svelte
│   │   │       ├── Chart.svelte
│   │   │       └── CSVImport.svelte
│   │   └── app.css
│   ├── package.json
│   ├── svelte.config.js
│   └── vite.config.ts
├── CLAUDE.md
└── README.md
```

---

## Database Schema

### Tables

**user_settings**
- id, pin_hash, currency (default: USD), created_at

**categories**
- id, name, type (income/expense), is_default, icon, color, created_at

**transactions**
- id, amount, type (income/expense), category_id, description, date, created_at

**budgets**
- id, category_id, amount, month (YYYY-MM), created_at

**recurring_transactions**
- id, amount, type, category_id, description, frequency (daily/weekly/monthly), next_run_date, is_active, created_at

**goals**
- id, name, target_amount, current_amount, deadline, created_at

---

## API Endpoints

### Auth
- `POST /api/auth/setup` - Set initial PIN
- `POST /api/auth/login` - Verify PIN, return session token
- `POST /api/auth/change-pin` - Change PIN

### Transactions
- `GET /api/transactions` - List (with filters: date range, category, type)
- `POST /api/transactions` - Create
- `PUT /api/transactions/{id}` - Update
- `DELETE /api/transactions/{id}` - Delete

### Categories
- `GET /api/categories` - List all
- `POST /api/categories` - Create custom
- `PUT /api/categories/{id}` - Update
- `DELETE /api/categories/{id}` - Delete (only custom)

### Budgets
- `GET /api/budgets?month=YYYY-MM` - Get month's budgets
- `POST /api/budgets` - Create/update budget
- `GET /api/budgets/status?month=YYYY-MM` - Budget vs actual spending

### Recurring
- `GET /api/recurring` - List all
- `POST /api/recurring` - Create
- `PUT /api/recurring/{id}` - Update
- `DELETE /api/recurring/{id}` - Delete
- `POST /api/recurring/process` - Trigger auto-generation (called on app startup/daily)

### Goals
- `GET /api/goals` - List all
- `POST /api/goals` - Create
- `PUT /api/goals/{id}` - Update (including adding to current_amount)
- `DELETE /api/goals/{id}` - Delete

### Reports
- `GET /api/reports/monthly-summary?month=YYYY-MM` - Income, expenses, net
- `GET /api/reports/category-breakdown?month=YYYY-MM` - Spending by category
- `GET /api/reports/trends?months=6` - Monthly totals over time

### Import
- `POST /api/import/csv` - Upload and parse CSV
- `POST /api/import/preview` - Preview parsed data before confirm
- `POST /api/import/confirm` - Commit imported transactions

---

## Default Categories

**Expenses**: Food & Dining, Transportation, Housing, Utilities, Healthcare, Entertainment, Shopping, Personal Care, Education, Other Expense

**Income**: Salary, Freelance, Investments, Gifts, Other Income

---

## Implementation Order

### Phase 1: Backend Foundation
1. Set up Python venv and install dependencies
2. Create FastAPI app structure
3. Set up SQLite + SQLAlchemy
4. Implement models and database initialization
5. Seed default categories

### Phase 2: Core Backend APIs
1. Auth endpoints (PIN setup/login)
2. Categories CRUD
3. Transactions CRUD
4. Budgets CRUD

### Phase 3: Advanced Backend
1. Recurring transactions + auto-generation service
2. Goals CRUD
3. Reports/analytics endpoints
4. CSV import service

### Phase 4: Frontend Foundation
1. Set up SvelteKit project
2. Create API client
3. Implement auth flow (PIN entry)
4. Basic layout and navigation

### Phase 5: Frontend Features
1. Dashboard with summary
2. Transaction list and form
3. Categories management
4. Budget setup and tracking view

### Phase 6: Frontend Advanced
1. Recurring transactions management
2. Goals with progress visualization
3. Reports page with charts (use Chart.js or similar)
4. CSV import UI
5. Settings page

---

## Key Dependencies

### Backend (requirements.txt)
```
fastapi
uvicorn[standard]
sqlalchemy
pydantic
python-multipart
passlib[bcrypt]
python-jose[cryptography]
```

### Frontend (package.json)
```
@sveltejs/kit
chart.js
svelte-chartjs (or similar)
```

---

## Verification Plan

1. **Backend**: Run `pytest` for API tests
2. **Frontend**: Run `npm run dev` and manually test flows
3. **End-to-end**:
   - Set up PIN → Login
   - Add transactions → Verify in list
   - Set budget → Check budget status calculation
   - Create recurring → Trigger process → Verify new transaction created
   - Create goal → Add to current amount → Check progress
   - Import CSV → Preview → Confirm → Verify transactions
   - View reports → Confirm chart data matches transactions
